<!DOCTYPE html>
<html lang = "en">

 <head>
	<meta name=apple-mobile-web-app-capable content=yes>
    <meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <title>Report Match</title>
	<link rel="apple-touch-icon" sizes="180x180" href="img/MorIcon.png">
	<link rel="apple-touch-startup-image" href="img/MorStartup.png" media="(device-width: 414px)">
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:700,300,400' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Exo+2:100' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/index.css" type="text/css">
	<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
 </head>
 
<body>

<nav class="navbar navbar-default navbar-fixed-top">
	<div class="container-fluid">
		<div class="navbar-header">
		  <a class="navbar-brand" id="morscout" href="javascript:if(!window.history.back()) window.history.back(2);" ><span class="glyphicon glyphicon-chevron-left"></span> back</a>
		   <a class="navbar-brand current_page" href="#">Report</a>
		  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#MorScoutNav" id = "toggle_button">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span> 
		  </button>
		</div>
		<div class="collapse navbar-collapse" id="MorScoutNav">
		  <ul class="nav navbar-nav">
			<li><a href="matches.html"title="List of all matches">All Matches</a></li>
			<li><a href="teams.html"title="List of all teams">Team List</a></li>
			<li><a href="sync.html"title="Sync with the server" >Sync</a></li>
			<li><a href="settings.html" title="Configure the settings">Settings</a></li>
		  </ul>
		  <ul class="nav navbar-nav navbar-right">
			<li><a class = "rightlinks" href="help.html" title="Need help?">Help</a></li>
			<li><a class = "rightlinks" href="feedback.html" title="Give team 1515 your feedback!">Feedback</a></li>
			<li id="UserDropdown" class="dropdown">
				<a class = "rightlinks" href="login.html">Log in</a>
			</li>
		  </ul>
		</div>
	</div>
</nav>

<div class = "report">
	<div class = "container-fluid">
		<div id="report_title" class="page_title">
			<h2>Match </h2>
			<h2 id="report_match_num"></h2>
			<h2> - </h2>
			<h2 id="report_match_time"></h2>
			<h2 id="report_instruction">Choose a team to scout or view</h2>
		</div>
		<div class="row">
			<div class = "col-md-12">
				<table class="report_table">
					<tr>
						<th id="rh">Red Teams</th>
						<th id="bh">Blue Teams</th>
					</tr>
					<tr>
						<td id="r1"></td>
						<td id="b1"></td>
					</tr>
					<tr>
						<td id="r2"></td>
						<td id="b2"></td>
					</tr>
					<tr>
						<td id="r3"></td>
						<td id="b3"></td>
					</tr>
				</table>
			</div>	
		</div>
		<div class="row">
			<div class="col-md-1 col-sm-0 col-xs-0">
			</div>	
			<div class="col-md-10 col-sm-12 col-xs-12">
				<ul id="report_tabs" class="nav nav-tabs">
				  <li id="scout_tab" class="active"><a href="javascript: void(0);">Scout</a></li>
				  <li id="view_tab"><a href="javascript: void(0);">View</a></li>
				</ul>	
			</div>
			<div class="col-md-1 col-sm-0 col-xs-0">
			</div>
		</div>			
		<div id="scout_form" class="row">
			<div class="col-md-1 col-sm-0 col-xs-0">
			</div>	
			<div class="col-md-5 col-sm-6 col-xs-12">
	  	    	<div class="scout_div">
	  	    		<h3 class="scout_div_title">Autonomous</h3>

	  	    		<div class="radio">
		  	    		<input class="report_check" type="radio" name="auto" id="nearDrivers"></input>
		  	    		<label id="report_text" for="nearDrivers" class="report_radio_check">Started near drivers</label><br/>
						<input class="report_check" type="radio" name="auto" id="radio12"></input>
						<label id="report_text" for="radio12" class="report_radio_check">Started near landfill</label><br/>
					</div>	

	  	    		<input class="report_check" type="checkbox" id="robotMoved"></input>
	  	    		<label id="report_text" for="robotMoved" class="report_radio_check">Robot moves to auto zone?</label><br/>

					<input class="report_check" type="checkbox" id="toteMoved"></input>
					<label id="report_text" for="toteMoved" class="report_radio_check">Tote moved to auto zone?</label><br/>

					<input class="report_check" type="checkbox" id="containerMoved"></input>
					<label id="report_text" for="containerMoved" class="report_radio_check">Container set on auto zone?</label><br/>

					<input class="report_check" type="checkbox" id="toteStacked"></input>
					<label id="report_text" for="toteStacked" class="report_radio_check">Single stacked tote set?</label><br/>

	  	    		<p id="report_text">Highest level tote stacked: </p>
	  	    		<input id="report_box_small" class="highestToteAuto" type="number"></input><br/>

	  	    		<textarea id="autoComments" class="report_area" placeholder="comments"></textarea> 
	  	    	</div>	
			</div>
			<div class="col-md-5 col-sm-6 col-xs-12">
				<div class="scout_div">
				    <h3 class="scout_div_title">Teleop</h3>  

					<p id="report_text">Gray tote scored</p>
	  	    		<input type="button" id="grayTotesMinus" class="button add_minus_button" value="-"></input>
	  	    		<input class="grayTotes" id="report_box_small" type="number" value="0"></input>
	  	    		<input type="button" id="grayTotesPlus" class="button add_minus_button" value="+"></input><br/> 

	  	    		<p id="report_text">Container scored</p>
	  	    		<input type="button" id="containersMinus" class="button add_minus_button" value="-"></input>
	  	    		<input class="containers" id="report_box_small" type="number" value="0"></input>
	  	    		<input type="button" id="containersPlus" class="button add_minus_button" value="+"></input><br/> 

	  	    		<p id="report_text">Litter in container</p>
	  	    		<input type="button" id="containerLitterMinus" class="button add_minus_button" value="-"></input>
	  	    		<input class="containerLitter" id="report_box_small" type="number" value="0"></input>
	  	    		<input type="button" id="containerLitterPlus" class="button add_minus_button" value="+"></input><br/> 

	  	    		<p id="report_text">Litter put in landfill</p>
	  	    		<input type="button" id="landfillLitterMinus" class="button add_minus_button" value="-"></input
	  	    		><input class="landfillLitter" id="report_box_small" type="number" value="0"></input>
	  	    		<input type="button" id="landfillLitterPlus" class="button add_minus_button" value="+"></input><br/>

	  	    		<p id="report_text">Highest level tote stacked: </p>
	  	    		<input id="report_box_small" type="number" class="highestToteTeleop"></input><br/>

	  	    		<input class="report_check" type="checkbox" id="landfillContainer"></input>
	  	    		<label id="report_text" for="landfillContainer" class="report_radio_check">Gets container from landfill?</label><br/> 
	  	    		<div class="radio">
		  	    		<input class="report_check" type="radio" id="coopertitionSet" name="coopertition"></input>
		  	    		<label id="report_text" for="coopertitionSet" class="report_radio_check">Coopertition set</label><br/>
						<input class="report_check" type="radio" id="coopertitionStack" name="coopertition"></input>
						<label id="report_text" for="coopertitionStack" class="report_radio_check">Coopertition stack</label><br/>
					</div>
					<textarea id="teleopComments" class="report_area" placeholder="comments"></textarea> 
				</div>
				<div class="submit_match">
					<button id="submit_match_report" class="button">Submit</button>
				</div>	
			</div>
			<div class="col-md-1 col-sm-0 col-xs-0">
			</div>		
		</div>	
		<div id="view_form" class="row">
			<div class="col-md-1 col-sm-0 col-xs-0">
			</div>	
			<div class="col-md-5 col-sm-6 col-xs-12">
				<div class="scout_div">
	  	    		<h3 class="scout_div_title view_title">Autonomous</h3>
	  	    		<table id="view_table">
	  	    			<tr>
	  	    				<td>Started near</td>
	  	    				<td id="view_nearDrivers">No Info</td>	
	  	    			</tr>
	  	    			<tr>
	  	    				<td>Robot moved to auto zone</td>
	  	    				<td id="view_robotMoved">No Info</td>	
	  	    			</tr>	
	  	    			<tr>
	  	    				<td>Tote set on auto zone</td>
	  	    				<td id="view_toteMoved">No Info</td>	
	  	    			</tr>
	  	    			<tr>
	  	    				<td>Container set on auto zone</td>
	  	    				<td id="view_containerMoved">No Info</td>	
	  	    			</tr>
	  	    			<tr>
	  	    				<td>Totes stacked on auto zone</td>
	  	    				<td id="view_toteStacked">No Info</td>	
	  	    			</tr>
	  	    			<tr>
	  	    				<td>Highest leve tote stacked</td>
	  	    				<td id="view_highestToteAuto">No Info</td>	
	  	    			</tr>
	  	    			<tr>
	  	    				<td>Can get container from landfill</td>
	  	    				<td id="view_landfillContainer">No Info</td>	
	  	    			</tr>		
	  	    			<tr>
	  	    				<td>Comments</td>
	  	    				<td id="view_autoComments">No Info</td>	
	  	    			</tr>					
	  	    		</table>	
	  	    	</div>	
			</div>
			<div class="col-md-5 col-sm-6 col-xs-12">
				<div class="scout_div">
	  	    		<h3 class="scout_div_title view_title">Teleop</h3>
	  	    		<table id="view_table">
	  	    			<tr>
	  	    				<td>Gray totes scored</td>
	  	    				<td id="view_grayTotes">No Info</td>	
	  	    			</tr>
	  	    			<tr>
	  	    				<td>Containers scored</td>
	  	    				<td id="view_containers">No Info</td>	
	  	    			</tr>	
	  	    			<tr>
	  	    				<td>Litter in containers</td>
	  	    				<td id="view_containerLitter">No Info</td>	
	  	    			</tr>
	  	    			<tr>
	  	    				<td>Litter put in landfill</td>
	  	    				<td id="view_landfillLitter">No Info</td>	
	  	    			</tr>
	  	    			<tr>
	  	    				<td>Highest level tote stacked</td>
	  	    				<td id="view_highestToteTeleop">No Info</td>	
	  	    			</tr>
	  	    			<tr>
	  	    				<td>Coopertition set</td>
	  	    				<td id="view_coopertitionSet">No Info</td>	
	  	    			</tr>	
	  	    			<tr>
	  	    				<td>Coopertition stack</td>
	  	    				<td id="view_coopertitionStack">No Info</td>	
	  	    			</tr>	
	  	    			<tr>
	  	    				<td>Comments</td>
	  	    				<td id="view_teleopComments">No Info</td>	
	  	    			</tr>					
	  	    		</table>	
	  	    	</div>	
			</div>		
			<div class="col-md-1 col-sm-0 col-xs-0">
			</div>	
		</div>	
	</div>
</div>
	
<!-- JAVASCRIPT -->		
	
<script src="js/jquery-2.1.3.min.js"></script>
<script src="js/bootstrap.min.js"></script>	
<script type='application/javascript' src='js/fastclick.js'></script>	
<script type="text/javascript" src="js/links.js"></script>	

<script src="js/reportTable.js"></script>	
<script src="js/main.js" type="text/javascript"></script>

<script>
if ('addEventListener' in document) {
    document.addEventListener('DOMContentLoaded', function() {
        FastClick.attach(document.body);
    }, false);
}
</script>

<script>

	$(document).ready(function() {

		$('#scout_form').hide();
		$('#view_form').hide();
		$('#report_tabs').hide();
		
		var viewDataMatch = function() {
			var data = JSON.parse(localStorage.data);
			if(data && data[localStorage.team] && data[localStorage.team][localStorage.match]){
				var report;
				var match = JSON.parse(localStorage.data)[localStorage.team][localStorage.match];
				for(var user in match) {
					if(match[user].length > 0) {
						report = match[user].last().data;
						break;
					}
				}
				if(report) {
					if(report.nearDrivers){
						$('#view_nearDrivers').html("Drivers")
					}else{
						$('#view_nearDrivers').html("Landfill")
					}
					$('#view_teleopComments').html(report.teleopComments)
					$('#view_highestToteAuto').html(report.highestToteAuto)
					$('#view_grayTotes').html(report.grayTotes)
					$('#view_containers').html(report.containers)
					$('#view_containerLitter').html(report.containerLitter)
					$('#view_landfillLitter').html(report.landfillLitter)
					$('#view_highestToteTeleop').html(report.highestToteTeleop)
					$('#view_autoComments').html(report.autoComments)
					$('#view_robotMoved').html(report.robotMoved.toString())
					$('#view_toteMoved').html(report.toteMoved.toString())
					$('#view_containerMoved').html(report.containerMoved.toString())
					$('#view_toteStacked').html(report.toteStacked.toString())
					$('#view_landfillContainer').html(report.landfillContainer.toString())
					$('#view_coopertitionSet').html(report.coopertitionSet.toString())
					$('#view_coopertitionStack').html(report.coopertitionStack.toString())
				}
			}
		};

		$('.report_table td').bind('touchstart',function(){
			$(this).addClass('button_hovered_report')
		});
		$('.report_table td').bind('touchend',function(){
			$(this).removeClass('button_hovered_report')
		});
		$('.report_table td').hover(function(){
			$(this).toggleClass('button_hovered_report')
		});
		$('.report_table td').click(function(){
			$('#view_nearDrivers').html("No Info")
			$('#view_teleopComments').html("No Info")
			$('#view_highestToteAuto').html("No Info")
			$('#view_grayTotes').html("No Info")
			$('#view_containers').html("No Info")
			$('#view_containerLitter').html("No Info")
			$('#view_landfillLitter').html("No Info")
			$('#view_highestToteTeleop').html("No Info")
			$('#view_autoComments').html("No Info")
			$('#view_robotMoved').html("No Info")
			$('#view_toteMoved').html("No Info")
			$('#view_containerMoved').html("No Info")
			$('#view_toteStacked').html("No Info")
			$('#view_landfillContainer').html("No Info")
			$('#view_coopertitionSet').html("No Info")
			$('#view_coopertitionStack').html("No Info")
			localStorage.removeItem('team');
			localStorage.team = $(this).text();
			$('td').removeClass('button_selected_report');
 			$(this).addClass('button_selected_report');
 			$('#scout_form').fadeIn(300);
			$('#report_tabs').fadeIn(300);
			$('#scout_tab').trigger("click");
			// location = "reportTeam.html?" + getQS({"team" : $(this).text()});
		});
		$('#view_tab').click(function(){
			$('#view_tab').addClass("active");
			$('#scout_tab').removeClass('active');
			$('#scout_form').hide();
			$('#view_form').show();
			viewDataMatch();
			if(navigator.onLine){
				autoSync();
			}	
		});
		$('#scout_tab').click(function(){
			$('#scout_tab').addClass("active");
			$('#view_tab').removeClass('active');
			$('#scout_form').show();
			$("#view_form").hide();
			$('#submit_match_report').html('Submit');
			$('#submit_match_report').prop('disabled', false);
			$('#submit_match_report').css({"background-color":"orange","color":"black"});
			if(navigator.onLine){
				autoSync();
			}	
		});
		
		$('#submit_match_report').click(function(){

			var report = {
				"meta" : {
					"team" : localStorage.team,
					"match" : localStorage.match,
					"time" : new Date().getTime()
				},
				"data" : {
					autoComments : $('#autoComments').val(),
					teleopComments : $('#teleopComments').val(),
					highestToteAuto : parseInt($('.highestToteAuto').val()) || 0,
					grayTotes : parseInt($('.grayTotes').val()) || 0,
					containers : parseInt($('.containers').val()) || 0,
					containerLitter : parseInt($('.containerLitter').val()) || 0,
					landfillLitter : parseInt($('.landfillLitter').val()) || 0,
					highestToteTeleop : parseInt($('.highestToteTeleop').val()) || 0,
					nearDrivers : $('#nearDrivers').is(':checked'),
					robotMoved : $('#robotMoved').is(':checked'),
					toteMoved : $('#toteMoved').is(':checked'),
					containerMoved : $('#containerMoved').is(':checked'),
					toteStacked : $('#toteStacked').is(':checked'),
					landfillContainer : $('#landfillContainer').is(':checked'),
					coopertitionSet : $('#coopertitionSet').is(':checked'),
					coopertitionStack : $('#coopertitionStack').is(':checked')
				}
			};

			var arr = parseJSON(localStorage.unSynced) || [];
			arr.push(report);
			localStorage.unSynced = JSON.stringify(arr);

			var data = JSON.parse(localStorage.data);
			if(!data[localStorage.team]) data[localStorage.team] = {};
			if(!data[localStorage.team][localStorage.match]) data[localStorage.team][localStorage.match] = {};
			if(!data[localStorage.team][localStorage.match][localStorage.user]) data[localStorage.team][localStorage.match][localStorage.user] = [];
			data[localStorage.team][localStorage.match][localStorage.user].push(report);
			localStorage.data = JSON.stringify(data);

			if(navigator.onLine){
				sync();
				$('#submit_match_report').html('Done!');
				$('#submit_match_report').prop('disabled', true);
				$('#submit_match_report').removeClass('button_hovered');
				$('#submit_match_report').css({"background-color":"black","color":"orange"});
			} else {
				alert("Data was saved. Sync when internet connection is available.")
			}
		});

		var grayTotes = 0;
		var containers = 0;
		var containerLitter = 0;
		var landfillLitter = 0;

		$('#grayTotesPlus').click(function(){
			grayTotes++;
			$('.grayTotes').val(grayTotes);
		});
		$('#grayTotesMinus').click(function(){
			grayTotes--;
			if(grayTotes<0){
				grayTotes=0;
			}
			$('.grayTotes').val(grayTotes);
		});
		$('#containersPlus').click(function(){
			containers++;
			$('.containers').val(containers);
		});
		$('#containersMinus').click(function(){
			containers--;
			if(containers<0){
				containers=0;
			}
			if(containerLitter>containers){
				containerLitter=containers;
			}
			$('.containers').val(containers);
			$('.containerLitter').val(containerLitter);
		});
		$('#containerLitterPlus').click(function(){
			containerLitter++;
			if(containerLitter>containers){
				containerLitter--;
			}
			$('.containerLitter').val(containerLitter);
		});
		$('#containerLitterMinus').click(function(){
			containerLitter--;
			if(containerLitter<0){
				containerLitter=0;
			}
			$('.containerLitter').val(containerLitter);
		});
		$('#landfillLitterPlus').click(function(){
			landfillLitter++;
			$('.landfillLitter').val(landfillLitter);
		});
		$('#landfillLitterMinus').click(function(){
			landfillLitter--;
			if(landfillLitter<0){
				landfillLitter=0;
			}
			$('.landfillLitter').val(landfillLitter);
		});

	});
</script>

</body>
</html>